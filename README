SYNOPSIS

SubRecon: Probabilistic Reconstruction of Ancestral Substitutions

CITATION

[Please cite Monit, C. and Goldstein, R. A. manuscript in preparation etc ]

INSTALLATION

First clone or download this git repository and then compile using Apache Ant (http://ant.apache.org/).

$ cd SubRecon-master
$ ant
$ ls dist/
SubRecon.jar

OPTIONS

	Summary:
	$ java -jar SubRecon.jar 
		-sequences <protein_sequence_alignment>
		-tree <newick_tree_file>
		-model <substitution_model>
		[-frequencies <A>,<R>,<N>,...,<Y>]
		[-site <site_index>]	
		[-threshold <print_threshold>]
		[-nosort]
		[-phy]
		[-verbose]
		[-help]

	Required:
	-sequences, -s
       		Amino acid sequence alignment 
		(Assumes FASTA format by default)	
	-tree, -t
       		Newick format tree file, rooted on the branch of interest 
		(NB branch lengths should have been estimated in advance with the same model specified here) 
	-model, -m
       		Amino acid substitution model: dayhoff, jtt, wag or blosum62
	
	Optional:
	-frequencies, -pi
       		Equilibrium frequencies for amino acids, delimited by comma in order:
       		A,R,N,D,C,Q,E,G,H,I,L,K,M,F,P,S,T,W,Y,V
		(Uses model's original estimated frequencies by default)
	-site
	     	Single alignment column to analyse
		(Analyse all columns by default)
	-threshold
       		Minimum probability value for a substitution to be displayed 
		(Default is 0.01. NB '-threshold 0.0' will print all 400 possibilities)
	-nosort
       		Do NOT sort transition probabilities in descending order, but by amino acid canonical order instead
	-phy
       		Alignment is in Phylip format
		(Assumes FASTA format by default)
	-verbose, -v
       		Print results for all sites, including those where Prob(I->I) >= 1 - [threshold]
		(Such sites are omitted from the results by default)
	-help, -h
		Print help information and exit

USAGE

Simple example:
	$ java -jar SubRecon.jar -s alignment.fasta -t tree.nwk.tre -m wag > subrecon.out.txt

Command line arguments can be placed in a file, where a space in the above command is replaced with a newline:
	$ cat args
	-s
	alignment.fasta
	-t
	tree.nwk.tre
	-m
	wag

The program can then be run:
	$ java -jar SubRecon.jar @args > subrecon.out.txt

DATA PREPARATION

The protein sequence alignment can be accepted in either FASTA (default) or Phylip format (-phy flag).

The tree must be saved in a file as Newick format and rooted on the branch of interest. 

E.g. consider a tree with four taxa where the branch of interest is that connecting clades (taxon1,taxon2) and (taxon3,taxon4):

((taxon1:0.05,taxon2:0.05):0.05,(taxon3:0.05,taxon4:0.05)L:0.05);

The branch of interest is of length 0.1, but is divided in half by the root node.

The program will compute the probabilities of substitutions from states at node (taxon1,taxon2) to states at node (taxon3,taxon4) or vise versa (since the applicable substitution models are reversible).


CONTROLLING OUTPUT

The default output shows firstly information about the substitution model used and then results for sites analysed.

The results columns show the site index, the marginal site log-likelihood and then a list of substitutions with probabilities above the threshold value, in descending order of probability. A site's results are only printed if at least one non-identical (I != J) substitution has probability above the threshold.

The output can be controlled with the -threshold -nosort and -verbose options.

E.g. 
	$ java -jar SubRecon.jar -s aln -t tree -m wag -threshold 0.0 -nosort -verbose

This will print all 20x20=400 substitution probabilities, in canonical amino acid order, for all sites.
